<script>
  function onUseAbility() {
    const abilityDataPath = getNearestParentDataPath(dataPath);
    const ability = api.getValue(abilityDataPath);
    useAbility(record, ability, abilityDataPath);
  }
</script>

<accordion field="abilityDetailsAccordion" size="xs">
  <accordion.control>
    <div style="display: flex; flex-direction: column; gap: 4px">
      <div
        style="
          display: flex;
          flex-direction: row;
          gap: 4px;
          align-items: center;
        "
      >
        <div
          style="width: 30px; height: 30px; min-height: 30px; min-width: 30px"
        >
          <portrait width="30px" height="30px" field="portrait"></portrait>
        </div>
        <namefield
          field="name"
          size="sm"
          width="100%"
          variant="unstyled"
          bold="true"
          placeholder="Ability Name..."
        ></namefield>
        <stringfield
          field="range"
          size="xs"
          label="Range"
          width="100px"
          variant="tooltip-underline"
          placeholder="Range..."
          editable="false"
        ></stringfield>
        <stringfield
          field="difficulty"
          size="xs"
          width="100px"
          label="Difficulty"
          variant="tooltip-underline"
          placeholder="Difficulty..."
          editable="false"
        ></stringfield>
        <div style="min-width: 50px">
          <button
            field="useBtn"
            size="xs"
            label="Use"
            variant="light"
            width="100%"
            onclick="onUseAbility();"
          ></button>
        </div>
      </div>
    </div>
  </accordion.control>
  <richtextfield
    field="description"
    size="xs"
    width="100%"
    disablecontrols="true"
  ></richtextfield>
  <div style="display: flex; flex-direction: column; gap: 4px; margin-top: 4px">
    <label
      size="xs"
      variant="bold"
      label="Additional Effects"
      field="abilityUpgradesLabel"
    ></label>
    <list listtype="ability_upgrades_list" field="abilityUpgrades"></list>
  </div>
</accordion>
